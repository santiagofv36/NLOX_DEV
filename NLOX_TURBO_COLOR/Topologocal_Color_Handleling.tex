\documentclass[a4paper]{article}

% \usepackage[spanish]{babel}
% \usepackage[utf8x]{inputenc}
\usepackage{pgf}
\usepackage{tikz}
\usetikzlibrary{arrows,automata}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amscd}
% \usepackage{esint}
% \usepackage{bbold}
\usepackage{graphicx}
\usepackage{slashed}

% \usepackage[colorinlistoftodos]{todonotes}
\addtolength{\oddsidemargin}{-.875in}
\addtolength{\evensidemargin}{-.875in}
\addtolength{\textwidth}{1.70in}
\addtolength{\topmargin}{-.875in}
\addtolength{\textheight}{1.50in}

\def \Int#1{\int d#1 \hskip0.1cm}

\def \FNode{\texttt{FNode} }
\def \FNodes{\texttt{FNodes} }
\def \FFLink{\texttt{FFLink} }
\def \FFLinks{\texttt{FFLinks} }
\def \NLOX{\texttt{NLOX} }


\title{Color Handling @\texttt{NLOX}}
\author{Diógenes Figueroa}
\begin{document}
% \date{Febrero 17 de 2017}
\maketitle
\section{Topological Color}
In this section we will discuss the method by which \texttt{NLOX} handles color matrices to reduce the number 
of evaluations of color traces. The general scheme is to recursively apply the following set of identities for 
$SU(N)$:

\begin{itemize}
 \item $f^{a_1a_2a_3} = -2i(Tr(T^{a_1} T^{a_2} T^{a_3})-Tr(T^{a_1} T^{a_3} T^{a_2}))$
 \item $(T^a)_{i_1i_2}(T^a)_{i_3i_4} = \frac{1}{2}\left(\delta_{i_1i_4}\delta_{i_2i_3} - \frac{1}{Nc}\delta_{i_1i_2}\delta_{i_3i_4}\right)$
 \item $Tr(T^a) = 0$
 \item $Tr(T^{a_1}T^{a_2})=\frac{1}{2}\delta^{a_1 a_2}$
\end{itemize}
This will fully simplify any sequence of $f$ and $T$ tensors down to (possibly) traces of $T$ matrices.
If the gauge group is different from $SU(N)$ there is no analougue for the second identity and one 
must use other methods, this is for example what happens for $SO(3,1)$ and prevents us from 
quickly evaluationg traces of $\gamma$ matrices. What follows is independent on the form of the previous 
identites and we only show their form for $SU(N)$ for completeness.

\subsection{On the redundancy of the $f-T$ representation}
If one considers the interference of large numbers of Feynman diagrams containig $f$ and $T$ tensors there 
could be lots of seemingly different combiantions of these tensors that, as it turns out, can be maped into 
a far smaller subset of generating sequences. For example, there are $12!$ sequences of $8$ fully contracted $f$ tensors, however, if we make full use of the anti-symmetry of the $f$ tensors it turns out there are only $8$ independent sqeunces.
\\ 

To understand how can we identify such independent sequences we have to change perspective, we identify every $f$ tnesor with an \texttt{FNode} which can connect to $3$ other \texttt{FNodes}.
Two \texttt{FNodes} are connected if they share an index. In our example of $8$ fully contracted $f$ tensors 
every node is connected to $3$ other \texttt{FNodes}.\\

But, why does this help?, let's assume a simpler scenario, that the $f$ tensors are symmetric rather than anti-symmetric. If so we could simply identify every graph were the same \FNodes share a contracted index
regardless on the position of such indices in each \FNode. Because the $f$ tensors are anti-symmetric 
we have to have a consistent way of keeping track of the sign difference that may arise between 
different equivalent sequences due to index transposition.\\

To further aid in the simplification we make use of the identities:
\begin{itemize}
 \item $f^{a_1 a_2 a_3} f^{a_1a_2a_4} = C_A \delta^{a_3a_4}$
 \item $f^{a_1 a_2 a_3} f^{a_1a_2a_3} = N_A C_A $
\end{itemize}
effectively what this does is to ensure that there are either $0$ or $1$ links between any two \texttt{FNodes}.\\

\noindent To achieve the full classification we need to:

\begin{itemize}
 \item Label all $f$ tensors as \FNodes in a topologiacally invariant way.
 \item Build a consistent rule for identifying a common index with a \FFLink between two \FNodes.
\end{itemize}
the first is by far the hardest and in general very expensive computationally, since the goal is to reduce computational expense we might have to settle for a procedurally generated identification rule that is not complete, but is cheap computationally.
The second point we need to have fully under control, we should point out that it is desirable 
to have a local procedure, meaning that the orientation defined as positive can be defined per \FNode
without having to look further than nearest neighboors. In contast global orientation tend to be expensive 
to decide and again defeat the purpose of reducing computational expense.\\

\subsection{Procedures @\NLOX}
The labelling used inside \NLOX is built to be very light, but still reduce the number of expressions 
to be evaluated significantly, we randomly pick a \FNode and label it as $\#1$,
then all the nodes connected to it are defined to be $\#2$, $\#3$, and $\#4$, there is a choice here which 
again we randomly make, we continue by moving on to \FNode $\#2$ and do the same, defining any undefined 
\FNode as the next label available. We then check all the pair-wise name transpositions to see if 
there is a choice which makes the sum of differences between linked \FNodes labels smaller. 
This will label some of the \FNodes which form triangles in consecutive order.\\

Now that we have a proper labeling on the \FNodes we can define a local orientation of each \FNode,
we define a the positive value of the orientation of \FNode as one that assings the connections 
in ascending order of the labels of the connected \FNodes. Let's work out an example, consider the sequence:

\begin{equation*}
\begin{aligned}
 f^{a_1a_2a_3}f^{a_4a_5a_6}f^{a_7a_8a_9}f^{a_1a_4a_7}f^{a_2a_5a_8}f^{a_3a_6a_9}
 \rightarrow
 &\texttt{FNode}(a_1,a_2,a_3;1)\texttt{FNode}(a_4,a_5,a_6;5)\texttt{FNode}(a_7,a_8,a_9;6)\\
 &\texttt{FNode}(a_1,a_4,a_7;2)\texttt{FNode}(a_2,a_5,a_8;3)\texttt{FNode}(a_3,a_6,a_9;4)\\
 \end{aligned}
\end{equation*}
following our labeling rules. Next we translate to labeled \FFLinks:

\begin{equation*}
\begin{aligned}
 \texttt{FNode}(a_1,a_2,a_3;1)\texttt{FNode}(a_4,a_5,a_6;5)\texttt{FNode}(a_7,a_8,a_9;6)
 &\rightarrow&
 \FFLink(1,2|1,1)\FFLink(1,3|2,1)\FFLink(1,4|3,1)\\
 \texttt{FNode}(a_1,a_4,a_7;2)\texttt{FNode}(a_2,a_5,a_8;3)\texttt{FNode}(a_3,a_6,a_9;4)
 &&\FFLink(2,5|2,1)\FFLink(2,6|3,1)\FFLink(3,5|2,2)\\
 &&\FFLink(3,6|3,2)\FFLink(4,5|3,3)\FFLink(4,6|3,3)\\
 \end{aligned}
\end{equation*}
the first two arguments of the \FFLink are the \FNodes it connects and the second two refer to which 
index of each participates in the \FFLink. Since we defined the positive orientation of the \FNode 
as the one that assigns the indices in order of labels we need to go into every \FNode and permute the 
indices until this is the case, and pay appropiate sign, once the \FNodes are well oriented we drop the 
secondary labels:

\begin{equation*}
\begin{aligned}
 \FFLink(1,2|1,1)\FFLink(1,3|2,1)\FFLink(1,4|3,1)
 &\rightarrow&
 \epsilon(1,2,3)\epsilon(1,2,3)\FFLink(1,2)\FFLink(1,3)\FFLink(1,4)\\
 \FFLink(2,5|2,1)\FFLink(2,6|3,1)\FFLink(3,5|2,2)
 &&
 \epsilon(1,2,3)\epsilon(1,2,3)\FFLink(2,5)\FFLink(2,6)\FFLink(3,5)\\
 \FFLink(3,6|3,2)\FFLink(4,5|3,3)\FFLink(4,6|3,3)
 &&
 \epsilon(1,2,3)\epsilon(1,2,3)\FFLink(3,6)\FFLink(4,5)\FFLink(4,6)\\
 \end{aligned}
\end{equation*}
each $\epsilon$ tensor comes from the reorientation of each \FNode to reference it 
against the positive orientation. Another definition we need to 
provide is which is the positive orientation of two \FNodes  are connceted multiple times, if
two connections are shared we choose 
the orientation to be positive if the outer two connections are the last connections for both 
\FNodes. If two \FNodes are fully connected the positive orientaton is defined as the orientation were all connections match possition between the two \FNodes.\\


\subsection{Colored Graphs}
A better way for understanding what the \texttt{FNodes} and \texttt{FFLinks} are refering to is to 
associate diagrams with each one, for a $\texttt{FNode}(a_1,a_2,a_3,;1)$, we draw:

\begin{center}
\begin{tikzpicture}[>=stealth',shorten >=1pt,auto,node distance=1.8cm,
                    semithick]
  \tikzstyle{every state}=[fill=red,draw=red,text=white,minimum size=5mm]

  \node[state] (1)                   {$1$};
  \node(a1)    [left of=1]           {$a_1$};
  \node(a2)    [above right of=1]    {$a_2$};
  \node(a3)    [below right of=1]    {$a_3$};
  \draw[red] 
        (1) edge              node {} (a1)
            edge              node {} (a2)
            edge              node {} (a3);
\end{tikzpicture}
\end{center}
the identity $f^{a_1 a_2 a_3} f^{a_1a_2a_4} = C_A \delta^{a_3a_4}$ corresponds to:
\begin{center}
\begin{tikzpicture}[>=stealth',shorten >=1pt,auto,node distance=2cm,
                    semithick]
  \tikzstyle{every state}=[fill=red,draw=red,text=white,minimum size=5mm]

  \node[state] (1)                   {$1$};
  \node(a1)    [left of=1]           {$a_3$};
  \node[state] (2) [right of=1]      {$2$};
  \node(a2)    [right of=2]           {$a_4$};
  \draw[red] 
        (1) edge   [bend right]         node {} (2)
        (1) edge   [bend left]          node {} (2)
        (1) edge node {} (a1)
        (2) edge node {} (a2);
  \node (a3) [right of=a2] {$C_A\times a_3$};
  \node (a4) [right of=a3] {$a_4$};
  \draw[black,->] 
  (a2) edge node{} (a3);
  \draw[red]
  (a3) edge node{} (a4);
\end{tikzpicture}
\end{center}

The \texttt{FFLinks} correspond to the edges of the graphs, in terms of graphs the equivalence becomes, that two expressions are equivalent if they have the same graph. Our example has the corresponding graph:

\begin{center}
\begin{tikzpicture}[>=stealth',shorten >=1pt,auto,node distance=2cm,
                    semithick]
  \tikzstyle{every state}=[fill=red,draw=red,text=white,minimum size=5mm]

  \node[state] (1)                   {$1$};
  \node[state] (2) [below of=1]      {$2$};
  \node[state] (3) [right of=2]      {$3$};
  \node[state] (4) [right of=3]      {$4$};
  \node[state] (5) [right of=1]      {$5$};
  \node[state] (6) [right of=5]      {$6$};
  
  \draw[red] 
        (1) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick]    node {} (2)
        (1) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick]    node {} (3)
        (1) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick]    node {} (4)
        (2) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick]    node {} (5)
        (2) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick]    node {} (6)
        (3) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick]    node {} (5)
        (3) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick]    node {} (6)
        (4) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick]    node {} (5)
        (4) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick]    node {} (6);
\end{tikzpicture}
\end{center}

this is the well-known bipartite graph $K_{3,3}$, the actual value of this graph is $0$. From now on we shall drop 
the labeling over the \FNodes, since the value of the grapsh is independent on this labeling. The relative spatial
possition of the nodes is also irrelevant for the value of the graph, for example the two graphs:

\begin{center}
\begin{tikzpicture}[>=stealth',shorten >=1pt,auto,node distance=2cm,
                    semithick]
  \tikzstyle{every state}=[fill=red,draw=red,minimum size=5mm]

  \node[state] (1)                   {};
  \node[state] (2) [below left of=1]      {};
  \node[state] (3) [above left of=1]      {};
  \node[state] (4) [right of=1]      {};
  \node[state] (5) [above right of=4]      {};
  \node[state] (6) [below right of=4]      {};
  \node[] (G1) [below right of=5] {};
  
  \draw[red] 
        (1) edge   []         node {} (2)
        (2) edge   []         node {} (3)
        (3) edge   []         node {} (1)
        (1) edge   []         node {} (4)
        (2) edge   []         node {} (6)
        (3) edge   []         node {} (5)
        (4) edge   []         node {} (5)
        (5) edge   []         node {} (6)
        (6) edge   []         node {} (4);
  \node[] (G2) [right of=G1]{}; 
  \node[state] (7) [right of=G2]                {};
  \node[state] (8) [above right of=7]      {};
  \node[state] (9) [below right of=7]      {};
  \node[state] (10) [right of=8]      {};
  \node[state] (11) [right of=9]      {};
  \node[state] (12) [below right of=10]      {};
%   \node[state] (aux) [below right of=9]{};
  
  \draw[red] 
        (8) edge   []         node {} (10)
        (10) edge   []         node {} (11)
        (11) edge   []         node {} (9)
        (9) edge   []         node {} (8)
        (7) edge   []         node {} (8)
        (7) edge   []         node {} (9)
        (12) edge   []         node {} (10)
        (12) edge   []         node {} (11)
        (7) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick] node {} (12);
  
  \draw[black,<->]
        (G1) edge node{}(G2);
\end{tikzpicture}
\end{center}

have the same value.

\subsection{Expression Classification using Graphs}
We now proceed to describe the classification procedure and how it is currently implemented in \texttt{NLOX}.
Graphs with only two nodes are evaluated down to a number trivially by the rules given in \eqref{}, so to start
we consider expressions with $4$ $f$ tensors, as we described before there is only one such strcture upon cannonical ordering, which is the tetrahedral graph:


\begin{center}
\begin{tikzpicture}[>=stealth',shorten >=0.5pt,auto,node distance=1.5cm,
                    semithick]
  \tikzstyle{every state}=[fill=red,draw=red,minimum size=5mm]
  \tikzstyle{equation} = [
    rectangle, rounded corners, inner sep=10pt, inner ysep=20pt]
  \node[state] (1)                   {};
  \node[state] (2) [above of=1]      {};
  \node[state] (3) [below left  of=1]      {};
  \node[state] (4) [below right of=1]      {};
  \node[] (Separator) [above right of=4]      {};
  \node[equation] (Value) [right of=Separator] {\begin{minipage}[ht!]{0.2\textwidth}
                                               ×\begin{equation*}
                                                   \hskip0.5cm =\hskip0.5cm  \frac{N_c^2(N_c^2-1)}{2}
                                                \end{equation*}
                                              \end{minipage}};
  \draw[red]
  (1) edge node{} (2)
  (1) edge node{} (3)
  (1) edge node{} (4)
  (2) edge [bend right]node{} (3)
  (3) edge [bend right]node{} (4)
  (4) edge [bend right]node{} (2);
  \end{tikzpicture}
\end{center}

for exprssions with $6$ \FNodes there are only $2$ possible graphs that are not trivially reduced to the tetrahedral graph, $K_{3,3}$ and the triangular prism graph shown above:

\begin{center}
\begin{tikzpicture}[>=stealth',shorten >=0.5pt,auto,node distance=1.5cm,
                    semithick]
  \tikzstyle{every state}=[fill=red,draw=red,minimum size=5mm]
  \tikzstyle{equation} = [
    rectangle, rounded corners, inner sep=10pt, inner ysep=20pt]
  

  \node[state] (1)                   {};
  \node[state] (2) [below left of=1]      {};
  \node[state] (3) [above left of=1]      {};
  \node[state] (4) [right of=1]      {};
  \node[state] (5) [above right of=4]      {};
  \node[state] (6) [below right of=4]      {};
  \draw[red] 
        (1) edge   []         node {} (2)
        (2) edge   []         node {} (3)
        (3) edge   []         node {} (1)
        (1) edge   []         node {} (4)
        (2) edge   []         node {} (6)
        (3) edge   []         node {} (5)
        (4) edge   []         node {} (5)
        (5) edge   []         node {} (6)
        (6) edge   []         node {} (4);

  \node[] (Separator) [above right of=6]      {};
  \node[equation] (Value) [right of=Separator] {\begin{minipage}{0.2\textwidth}
                                               ×\begin{equation*}
                                                   \hskip0.5cm =\hskip0.5cm \frac{N_c^3(N_c^2-1)}{4}
                                                \end{equation*}
                                              \end{minipage}};
\end{tikzpicture}  
\end{center}

\begin{center}
\begin{tikzpicture}[>=stealth',shorten >=0.5pt,auto,node distance=1.5cm,
                    semithick]
  \tikzstyle{every state}=[fill=red,draw=red,minimum size=5mm]
  \tikzstyle{equation} = [
    rectangle, rounded corners, inner sep=10pt, inner ysep=20pt]
  

  \node[state] (1){};
  
  \node[] (2B) [below of=1]      {};
  \node[state] (2) [below of=2B]      {};
  
  \node[state] (3) [right of=2]      {};
  \node[] (3B) [above of=3]      {};
  
  \node[state] (4) [right of=3]      {};
  \node[] (4B) [above of=4]      {};
  
  \node[state] (5) [right of=1]      {};
  \node[state] (6) [right of=5]      {};
  
  \draw[red] 
        (1) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick]   node {} (2)
        (1) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick]   node {} (3)
        (1) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick]   node {} (4)
        (2) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick]   node {} (5)
        (2) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick]   node {} (6)
        (3) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick]   node {} (5)
        (3) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick]   node {} (6)
        (4) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick]   node {} (5)
        (4) edge   [draw=white,double=red,double distance = \pgflinewidth,ultra thick]   node {} (6);
  \node[] (Separator) [right of=4B]      {};
  \node[equation] (Value) [right of=Separator] {\begin{minipage}{0.2\textwidth}
                                               ×\begin{equation*}
                                                   \hskip0.5cm =\hskip0.5cm 0
                                                \end{equation*}
                                              \end{minipage}};
\end{tikzpicture}  
\end{center}

while for $8$ \FNodes we 3 planar structures:
\begin{center}
\begin{tikzpicture}[>=stealth',shorten >=0.5pt,auto,node distance=1.5cm,
                    semithick]
  \tikzstyle{every state}=[fill=red,draw=red,minimum size=3mm]
  \tikzstyle{equation} = [
    rectangle, rounded corners, inner sep=10pt, inner ysep=20pt]
  
  \node[]      (20) at (0,0) [] {};
  \node[state] (21) at ( 0.6, 0.6) [] {};
  \node[state] (22) at (-0.6, 0.6) [] {};
  \node[state] (23) at (-0.6,-0.6) [] {};
  \node[state] (24) at ( 0.6,-0.6) [] {};
  \node[state] (25) at ( 1.2, 1.2) [] {};
  \node[state] (26) at (-1.2, 1.2) [] {}; 
  \node[state] (27) at (-1.2,-1.2) [] {};
  \node[state] (28) at ( 1.2,-1.2) [] {};
  
  \draw[red] 
        (21) edge  node {} (22)
        (22) edge  node {} (23)
        (23) edge  node {} (24)
        (24) edge  node {} (21)
        (25) edge  node {} (26)
        (26) edge  node {} (27)
        (27) edge  node {} (28)
        (28) edge  node {} (25)
        (21) edge  node {} (25)
        (22) edge  node {} (26)
        (23) edge  node {} (27)
        (24) edge  node {} (28);
  
  \tikzset{shift={(3.5,0)}}
  
  \node[] at (0,0) [] {};
  \node[state] (1) at (1,0) [] {};
  \node[state] (2) at (0.3090,0.9510) [] {};
  \node[state] (3) at (-0.809017, 0.587785) [] {};
  \node[state] (4) at (-0.809017, -0.587785) [] {};
  \node[state] (5) at (0.3090,-0.9510) [] {};
  \node[state] (6) at (2,0) {};
  \node[state] (7) [above right of=3] {};
  \node[state] (8) [below right of=4] {};
  
  \draw[red] 
        (1) edge  node {} (2)
        (2) edge  node {} (3)
        (3) edge  node {} (4)
        (4) edge  node {} (5)
        (5) edge  node {} (1)
        (1) edge  node {} (6)
        (2) edge  node {} (7)
        (5) edge  node {} (8)
        (6) edge  node {} (7)
        (6) edge  node {} (8)
        (7) edge  node {} (3)
        (8) edge  node {} (4);
  
  
  \tikzset{shift={(5.5,0)}}
  \node[]      (10) at (0,0) [] {};
  \node[state] (11) at (1,0) [] {};
  \node[state] (12) at (0.5,0.866025) [] {};
  \node[state] (13) at (-0.5,0.866025) [] {};
  \node[state] (14) at (-1,0) [] {};
  \node[state] (15) at (-0.5,-0.866025)  [] {};
  \node[state] (16) at (0.5,-0.866025) [] {};
  \node[state] (17) at (2,0) {};
  \node[state] (18) at (-2,0) {};
  
  \draw[red] 
        (11) edge  node {} (12)
        (12) edge  node {} (13)
        (13) edge  node {} (14)
        (14) edge  node {} (15)
        (15) edge  node {} (16)
        (16) edge  node {} (11)
        (17) edge  node {} (11)
        (17) edge  node {} (16)
        (17) edge  node {} (12)
        (18) edge  node {} (14)
        (18) edge  node {} (15)
        (18) edge  node {} (13);
  
  
  \end{tikzpicture}  
\end{center}











\end{document}
